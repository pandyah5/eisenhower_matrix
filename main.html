<!DOCTYPE html>
<html>
<head>

<!-- Importing Chart.js for plotting matrices -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.0/chart.js"></script>

<script>

// The variable to store the urgency and importance points
let data = new Map();

// Function to add the task item supplied by the user
function add_item () {
	// Create an entry for the new task on the list
	let taskname = document.getElementById("taskname").value;
	document.getElementById("To_do_list").innerHTML += ('<li id="'+ taskname +'">' + taskname);
	document.getElementById("To_do_list").innerHTML += ('<button id="btn_'+taskname+'" type="button" onclick="delete_item(\'' + taskname + '\')">X</button> </li>');
	
	// Add the task to the data hashmap with its U and I params
	let urgency = document.getElementById("urgency").value;
	let importance = document.getElementById("importance").value;
	let scatter_point = {x: urgency, y: importance};
	data.set(taskname, scatter_point);
	
	// For debug let us print all elements of data
	for (const [key, value] of data) {
		console.log(key + " is mapped to: " + value.x + ", " + value.y);
	}
	
	// Update the eisenhower matrix
	update_eisenhower_matrix();

	return;
}

// Function to delete the task item when the "X" button is clicked
function delete_item(taskname) {
	// Delete the text entry
	let elem = document.getElementById(taskname);
	elem.parentNode.removeChild(elem);

	// Delete the "X" button associated with it
	document.getElementById("btn_" + taskname).remove();
	
	// Delete the entry from the data hashmap
	data.delete(taskname);
	
	// Update the eisenhower matrix
	update_eisenhower_matrix();

	return;
}

function update_eisenhower_matrix () {
	// Extract the plot points and labels from data
	let plot_data = [];
	let plot_labels = [];
	let plot_colors = [];
	for (const[key, value] of data) {
		plot_labels.push(key);
		plot_data.push(value);
		
		// We will color code each quadrant
		if (value.x < 0 && value.y > 0) {
			plot_colors.push("rgba(0,0,150,1)");     // Blue
		}
		else if (value.x > 0 && value.y > 0) {
			plot_colors.push("rgba(240,160,13,1)");  // Orange
		}
		else if (value.x < 0 && value.y < 0) {
			plot_colors.push("rgba(0,150,0,1)");     // Green
		}
		else if (value.x > 0 && value.y < 0) {
			plot_colors.push("rgba(150,0,0,1)");     // Red
		}
		else {
			plot_colors.push("rgba(70,70,60,1)");    // Gray
		}
	}
	
	// Get the chart and edit the values
	myChart.data.datasets[0].pointBackgroundColor = plot_colors;
	myChart.data.datasets[0].labels = plot_labels;
	myChart.data.datasets[0].data = plot_data;
	
	// Update the chart
	myChart.update();
}

function change_matrix_state() {
	let elem = document.getElementById('matrix_mode_toggle_btn');
	let txt = elem.textContent;
	
	if (txt == 'Show Matrix') {
		elem.textContent = 'Hide Matrix';
	}
	else {
		elem.textContent = 'Show Matrix';
	}
}

</script>
</head>


<body>
<h1> This is an Eisenhower inspired to-do list! </h1>

<!-- Get the taskname -->
<label for="taskname">Item:</label>
<input type="text" value = "e.g. Water the plants" id="taskname" name="taskname" minlength="1" maxlength="20" required>

<!-- Get the urgency -->
<label for="urgency">Urgency:</label>
<input type="number" id="urgency" name="urgency" minlength="1" maxlength="20" required>

<!-- Get the importance -->
<label for="importance">Importance:</label>
<input type="number" id="importance" name="importance" minlength="1" maxlength="20" required>

<button type="button" onclick="add_item()">Add item!</button>

<p> Your to-do list: </p> 
<ul id="To_do_list">
</ul>

<div id="einsenhower">
	<canvas id="matrix" style="width:100%;max-width:700px"></canvas>
	<script>
	var ctx = document.getElementById('matrix').getContext("2d");
	
	// Configure the chart, Note: Needs to be after the canvas tag!
	var myChart = new Chart(ctx, {
	  type: "scatter",
	  data: {
			datasets: [{
				pointRadius: 4,
				pointBackgroundColor: "rgba(0,0,255,1)",
				label: 'Tasks',
				labels: [],
				data: []
			}]
		},
	  options: {
			plugins: {
				tooltip: {
					callbacks: {
						label: function(ctx) {
							let label = ctx.dataset.labels[ctx.dataIndex];
							label += " (" + ctx.parsed.x + ", " + ctx.parsed.y + ")";
							return label;
						}
					}
				}
			},
			title: {
				display: true,
				text: 'Eisenhower Matrix'
			},
			scales: {
				y: {
					min: -5,
					max: 5,
					grid: {
						display: true,
						color: "rgba(0,0,0,1)",
						lineWidth: 0.2
					}
				},
				x: {
					min: -5,
					max: 5,
					grid: {
						display: true,
						color: "rgba(0,0,0,1)",
						lineWidth: 0.2
					}
				}
			},
			elements: {
				point: {
					pointStyle: 'circle'
				}
			}
		}
	});
	</script>
</div>

<p id="credits"> Created by your beloved HP </p>
</body>
</html>